{% extends 'base.html' %}

{% block content %}
  <h2>Trades</h2>
  <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
    <div class="subtle">Showing page {{ page }} of {{ total_pages }} ({{ total }} total)</div>
    <div>
      <form method="get" style="display:inline-block;">
        <label class="subtle">Per page:</label>
        <input type="number" name="per_page" value="{{ per_page }}" min="1" style="width:72px;">
        <input type="hidden" name="page" value="1">
        <button type="submit">Set</button>
      </form>
    </div>
  </div>
  {% if trades %}
    <table style="width:100%; border-collapse: collapse;">
      <thead>
        <tr>
          <th style="text-align:left; padding:8px; border-bottom:1px solid #1f2a38">Date</th>
          <th style="text-align:left; padding:8px; border-bottom:1px solid #1f2a38">Symbol</th>
          <th style="text-align:right; padding:8px; border-bottom:1px solid #1f2a38">Size</th>
          <th style="text-align:right; padding:8px; border-bottom:1px solid #1f2a38">Entry</th>
          <th style="text-align:right; padding:8px; border-bottom:1px solid #1f2a38">Exit</th>
          <th style="text-align:right; padding:8px; border-bottom:1px solid #1f2a38">Profit</th>
        </tr>
      </thead>
      <tbody>
        {% for t in trades %}
          <tr class="card" style="background:transparent; border:0;">
            <td style="padding:8px">{{ t.trade_date }}</td>
            <td style="padding:8px">{{ t.symbol }}</td>
            <td style="padding:8px; text-align:right">{{ '%.2f'|format(t.position_size) }}</td>
            <td style="padding:8px; text-align:right">{{ '$%.2f'|format(t.entry_price) }}</td>
            <td style="padding:8px; text-align:right">{{ '$%.2f'|format(t.exit_price) }}</td>
            <td style="padding:8px; text-align:right" class="pl {% if t.profit >= 0 %}positive{% else %}negative{% endif %}">{{ '$%.2f'|format(t.profit) }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    <div style="display:flex; justify-content:space-between; align-items:center; margin-top:12px;">
      <div>
        {% if page > 1 %}
          <a href="?page={{ page-1 }}&per_page={{ per_page }}">&larr; Prev</a>
        {% endif %}
      </div>
      <div class="subtle">Page {{ page }} / {{ total_pages }}</div>
      <div>
        {% if page < total_pages %}
          <a href="?page={{ page+1 }}&per_page={{ per_page }}">Next &rarr;</a>
        {% endif %}
      </div>
    </div>
  {% else %}
    <p class="subtle">No trades found.</p>
  {% endif %}
{% endblock %}
